<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.thinkgem.jeesite.modules.order.dao.SupOrderDao">
    
	<sql id="supOrderColumns">
		a.id AS "id",
		a.order_id AS "orderId",
		a.api_order_id AS "apiOrderId",
		a.agent_id AS "agentId",
		a.agent_express_id AS "agentExpressId",
		a.agent_post_fee AS "agentPostFee",
		a.agent_payment AS "agentPayment",
		a.agent_pay_time AS "agentPayTime",
		a.agent_ip_address AS "agentIpAddress",
		a.channel_id AS "channelId",
		a.product_no AS "productNo",
		a.channel_confirm_time AS "channelConfirmTime",
		a.goods_size AS "goodsSize",
		a.channel_post_fee AS "channelPostFee",
		a.num AS "num",
		a.channel_send_time AS "channelSendTime",
		a.tag_price AS "tagPrice",
		a.agent_agio AS "agentAgio",
		a.confirm_user_id AS "confirmUserId",
		a.receiver_state AS "receiverState",
		a.reveiver_city AS "reveiverCity",
		a.reveiver_district AS "reveiverDistrict",
		a.receiver_name AS "receiverName",
		a.channel_received_fee AS "channelReceivedFee",
		a.receiver_mobile AS "receiverMobile",
		a.channel_agio AS "channelAgio",
		a.receiver_address AS "receiverAddress",
		a.express_no AS "expressNo",
		a.send_num AS "sendNum",
		a.logistics_company AS "logisticsCompany",
		a.agent_price AS "agentPrice",
		a.err_msg AS "errMsg",
		a.customer_service_id AS "customerServiceId",
		a.total_fee AS "totalFee",
		a.order_status AS "orderStatus",
		a.commission_fee AS "commissionFee",
		a.buyer_message AS "buyerMessage",
		a.shop_id AS "shopId",
		a.tid AS "tid",
		a.package_fee AS "packageFee",
		a.order_from AS "orderFrom",
		a.create_by AS "createBy.id",
		a.update_by AS "updateBy.id",
		a.commission_agio AS "commissionAgio",
		a.remarks AS "remarks",
		a.del_flag AS "delFlag",
		a.create_date AS "createDate",
		a.update_date AS "updateDate"
	</sql>
	
	<sql id="supOrderJoins">
	</sql>
    
	<select id="get" resultType="SupOrder">
		SELECT 
			<include refid="supOrderColumns"/>
		FROM sup_order a
		<include refid="supOrderJoins"/>
		WHERE a.id = #{id}
	</select>
	
	<select id="findList" resultType="SupOrder">
		SELECT 
			<include refid="supOrderColumns"/>
		FROM sup_order a
		<include refid="supOrderJoins"/>
		<where>
			a.del_flag = #{DEL_FLAG_NORMAL}
			<if test="orderId != null and orderId != ''">
				AND a.order_id LIKE 
					<if test="dbName == 'oracle'">'%'||#{orderId}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{orderId}+'%'</if>
					<if test="dbName == 'mysql'">concat('%',#{orderId},'%')</if>
			</if>
			<if test="productNo != null and productNo != ''">
				AND a.product_no LIKE 
					<if test="dbName == 'oracle'">'%'||#{productNo}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{productNo}+'%'</if>
					<if test="dbName == 'mysql'">concat('%',#{productNo},'%')</if>
			</if>
			<if test="receiverName != null and receiverName != ''">
				AND a.receiver_name LIKE 
					<if test="dbName == 'oracle'">'%'||#{receiverName}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{receiverName}+'%'</if>
					<if test="dbName == 'mysql'">concat('%',#{receiverName},'%')</if>
			</if>
			<if test="orderStatus != null and orderStatus != ''">
				AND a.order_status = #{orderStatus}
			</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
				ORDER BY a.update_date DESC
			</otherwise>
		</choose>
	</select>
	
	<select id="findAllList" resultType="SupOrder">
		SELECT 
			<include refid="supOrderColumns"/>
		FROM sup_order a
		<include refid="supOrderJoins"/>
		<where>
			a.del_flag = #{DEL_FLAG_NORMAL}
		</where>		
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
				ORDER BY a.update_date DESC
			</otherwise>
		</choose>
	</select>
	
	<insert id="insert">
		INSERT INTO sup_order(
			id,
			order_id,
			api_order_id,
			agent_id,
			agent_express_id,
			agent_post_fee,
			agent_payment,
			agent_pay_time,
			agent_ip_address,
			channel_id,
			product_no,
			channel_confirm_time,
			goods_size,
			channel_post_fee,
			num,
			channel_send_time,
			tag_price,
			agent_agio,
			confirm_user_id,
			receiver_state,
			reveiver_city,
			reveiver_district,
			receiver_name,
			channel_received_fee,
			receiver_mobile,
			channel_agio,
			receiver_address,
			express_no,
			send_num,
			logistics_company,
			err_msg,
			customer_service_id,
			total_fee,
			order_status,
			commission_fee,
			buyer_message,
			shop_id,
			tid,
			package_fee,
			order_from,
			create_by,
			update_by,
			commission_agio,
			remarks,
			del_flag,
			create_date,
			update_date,
			agent_price
		) VALUES (
			#{id},
			#{orderId},
			#{apiOrderId},
			#{agentId},
			#{agentExpressId},
			#{agentPostFee},
			#{agentPayment},
			#{agentPayTime},
			#{agentIpAddress},
			#{channelId},
			#{productNo},
			#{channelConfirmTime},
			#{goodsSize},
			#{channelPostFee},
			#{num},
			#{channelSendTime},
			#{tagPrice},
			#{agentAgio},
			#{confirmUserId},
			#{receiverState},
			#{reveiverCity},
			#{reveiverDistrict},
			#{receiverName},
			#{channelReceivedFee},
			#{receiverMobile},
			#{channelAgio},
			#{receiverAddress},
			#{expressNo},
			#{sendNum},
			#{logisticsCompany},
			#{errMsg},
			#{customerServiceId},
			#{totalFee},
			#{orderStatus},
			#{commissionFee},
			#{buyerMessage},
			#{shopId},
			#{tid},
			#{packageFee},
			#{orderFrom},
			#{createBy.id},
			#{updateBy.id},
			#{commissionAgio},
			#{remarks},
			#{delFlag},
			#{createDate},
			#{updateDate},
			#{agentPrice}
		)
	</insert>
	
	<update id="update">
		UPDATE sup_order SET 	
			order_id = #{orderId},
			api_order_id = #{apiOrderId},
			agent_id = #{agentId},
			agent_express_id = #{agentExpressId},
			agent_post_fee = #{agentPostFee},
			agent_payment = #{agentPayment},
			agent_pay_time = #{agentPayTime},
			agent_ip_address = #{agentIpAddress},
			channel_id = #{channelId},
			product_no = #{productNo},
			channel_confirm_time = #{channelConfirmTime},
			goods_size = #{goodsSize},
			channel_post_fee = #{channelPostFee},
			num = #{num},
			channel_send_time = #{channelSendTime},
			tag_price = #{tagPrice},
			agent_agio = #{agentAgio},
			confirm_user_id = #{confirmUserId},
			receiver_state = #{receiverState},
			reveiver_city = #{reveiverCity},
			reveiver_district = #{reveiverDistrict},
			receiver_name = #{receiverName},
			channel_received_fee = #{channelReceivedFee},
			receiver_mobile = #{receiverMobile},
			channel_agio = #{channelAgio},
			receiver_address = #{receiverAddress},
			express_no = #{expressNo},
			send_num = #{sendNum},
			logistics_company = #{logisticsCompany},
			err_msg = #{errMsg},
			customer_service_id = #{customerServiceId},
			total_fee = #{totalFee},
			order_status = #{orderStatus},
			commission_fee = #{commissionFee},
			buyer_message = #{buyerMessage},
			shop_id = #{shopId},
			tid = #{tid},
			package_fee = #{packageFee},
			order_from = #{orderFrom},
			update_by = #{updateBy.id},
			commission_agio = #{commissionAgio},
			remarks = #{remarks},
			update_date = #{updateDate},
			agent_price = #{agentPrice}
		WHERE id = #{id}
	</update>
	
	<update id="delete">
		UPDATE sup_order SET 
			del_flag = #{DEL_FLAG_DELETE}
		WHERE id = #{id}
	</update>
	
</mapper>