<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.thinkgem.jeesite.modules.order.dao.SupOrderDao">
    
	<sql id="supOrderColumns">
		a.order_id AS "orderId",
		a.api_order_id AS "apiOrderId",
		a.agent_id AS "agentId",
		a.agent_express_id AS "agentExpressId",
		a.agent_post_fee AS "agentPostFee",
		a.agent_total_fee AS "agentTotalFee",
		a.agent_pay_time AS "agentPayTime",
		a.agent_ip_address AS "agentIpAddress",
		a.channel_id AS "channelId",
		a.channel_confirm_time AS "channelConfirmTime",
		a.channel_post_fee AS "channelPostFee",
		a.channel_send_time AS "channelSendTime",
		a.channel_total_received_fee AS "channelTotalReceivedFee",
		a.confirm_user_id AS "confirmUserId",
		a.receiver_state AS "receiverState",
		a.reveiver_city AS "reveiverCity",
		a.reveiver_district AS "reveiverDistrict",
		a.receiver_name AS "receiverName",
		a.receiver_mobile AS "receiverMobile",
		a.receiver_address AS "receiverAddress",
		a.express_no AS "expressNo",
		a.logistics_company AS "logisticsCompany",
		a.err_msg AS "errMsg",
		a.customer_service_id AS "customerServiceId",
		a.total_fee AS "totalFee",
		a.order_status AS "orderStatus",
		a.commission_fee AS "commissionFee",
		a.buyer_message AS "buyerMessage",
		a.shop_id AS "shopId",
		a.tid AS "tid",
		a.package_fee AS "packageFee",
		a.order_from AS "orderFrom",
		a.create_by AS "createBy.id",
		a.create_time AS "createTime",
		a.update_by AS "updateBy.id",
		a.update_time AS "updateTime",
		a.remarks AS "remarks",
		a.del_flag AS "delFlag"
	</sql>
	
	<sql id="supOrderJoins">
	</sql>
    
	<select id="get" resultType="SupOrder">
		SELECT 
			<include refid="supOrderColumns"/>
		FROM sup_order a
		<include refid="supOrderJoins"/>
		WHERE a.id = #{id}
	</select>
	
	<select id="findList" resultType="SupOrder">
		SELECT 
			<include refid="supOrderColumns"/>
		FROM sup_order a
		<include refid="supOrderJoins"/>
		<where>
			a.del_flag = #{DEL_FLAG_NORMAL}
			<if test="orderId != null and orderId != ''">
				AND a.order_id LIKE 
					<if test="dbName == 'oracle'">'%'||#{orderId}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{orderId}+'%'</if>
					<if test="dbName == 'mysql'">concat('%',#{orderId},'%')</if>
			</if>
			<if test="receiverName != null and receiverName != ''">
				AND a.receiver_name LIKE 
					<if test="dbName == 'oracle'">'%'||#{receiverName}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{receiverName}+'%'</if>
					<if test="dbName == 'mysql'">concat('%',#{receiverName},'%')</if>
			</if>
			<if test="orderStatus != null and orderStatus != ''">
				AND a.order_status = #{orderStatus}
			</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
			</otherwise>
		</choose>
	</select>
	
	<select id="findAllList" resultType="SupOrder">
		SELECT 
			<include refid="supOrderColumns"/>
		FROM sup_order a
		<include refid="supOrderJoins"/>
		<where>
			a.del_flag = #{DEL_FLAG_NORMAL}
		</where>		
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
			</otherwise>
		</choose>
	</select>
	
	<insert id="insert">
		INSERT INTO sup_order(
			order_id,
			api_order_id,
			agent_id,
			agent_express_id,
			agent_post_fee,
			agent_total_fee,
			agent_pay_time,
			agent_ip_address,
			channel_id,
			channel_confirm_time,
			channel_post_fee,
			channel_send_time,
			channel_total_received_fee,
			confirm_user_id,
			receiver_state,
			reveiver_city,
			reveiver_district,
			receiver_name,
			receiver_mobile,
			receiver_address,
			express_no,
			logistics_company,
			err_msg,
			customer_service_id,
			total_fee,
			order_status,
			commission_fee,
			buyer_message,
			shop_id,
			tid,
			package_fee,
			order_from,
			create_by,
			create_time,
			update_by,
			update_time,
			remarks,
			del_flag
		) VALUES (
			#{orderId},
			#{apiOrderId},
			#{agentId},
			#{agentExpressId},
			#{agentPostFee},
			#{agentTotalFee},
			#{agentPayTime},
			#{agentIpAddress},
			#{channelId},
			#{channelConfirmTime},
			#{channelPostFee},
			#{channelSendTime},
			#{channelTotalReceivedFee},
			#{confirmUserId},
			#{receiverState},
			#{reveiverCity},
			#{reveiverDistrict},
			#{receiverName},
			#{receiverMobile},
			#{receiverAddress},
			#{expressNo},
			#{logisticsCompany},
			#{errMsg},
			#{customerServiceId},
			#{totalFee},
			#{orderStatus},
			#{commissionFee},
			#{buyerMessage},
			#{shopId},
			#{tid},
			#{packageFee},
			#{orderFrom},
			#{createBy.id},
			#{createTime},
			#{updateBy.id},
			#{updateTime},
			#{remarks},
			#{delFlag}
		)
	</insert>
	
	<update id="update">
		UPDATE sup_order SET 	
			order_id = #{orderId},
			api_order_id = #{apiOrderId},
			agent_id = #{agentId},
			agent_express_id = #{agentExpressId},
			agent_post_fee = #{agentPostFee},
			agent_total_fee = #{agentTotalFee},
			agent_pay_time = #{agentPayTime},
			agent_ip_address = #{agentIpAddress},
			channel_id = #{channelId},
			channel_confirm_time = #{channelConfirmTime},
			channel_post_fee = #{channelPostFee},
			channel_send_time = #{channelSendTime},
			channel_total_received_fee = #{channelTotalReceivedFee},
			confirm_user_id = #{confirmUserId},
			receiver_state = #{receiverState},
			reveiver_city = #{reveiverCity},
			reveiver_district = #{reveiverDistrict},
			receiver_name = #{receiverName},
			receiver_mobile = #{receiverMobile},
			receiver_address = #{receiverAddress},
			express_no = #{expressNo},
			logistics_company = #{logisticsCompany},
			err_msg = #{errMsg},
			customer_service_id = #{customerServiceId},
			total_fee = #{totalFee},
			order_status = #{orderStatus},
			commission_fee = #{commissionFee},
			buyer_message = #{buyerMessage},
			shop_id = #{shopId},
			tid = #{tid},
			package_fee = #{packageFee},
			order_from = #{orderFrom},
			create_time = #{createTime},
			update_by = #{updateBy.id},
			update_time = #{updateTime},
			remarks = #{remarks}
		WHERE id = #{id}
	</update>
	
	<update id="delete">
		UPDATE sup_order SET 
			del_flag = #{DEL_FLAG_DELETE}
		WHERE id = #{id}
	</update>
	
</mapper>